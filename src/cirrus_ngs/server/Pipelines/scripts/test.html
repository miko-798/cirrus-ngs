<html>
<body>
    <p><font size="6">All shell script names must be <= 10 characters (not including .sh extension)</font><br>
    &nbsp;&nbsp;&nbsp; This is required for PBSTracker to properly identify the jobs</p>
    <br><br>
    <p><strong><font size="4">Shell script format:</font></strong></p>
    <p><font color="blue">#!/bin/bash<br><br></font>
    project_name=<font color=#00ffff>$1</font><br>
    file_suffix=<font color=#00ffff><font color=#00ffff>$2</font></font>  <font color="blue">#extension of input file, does not include .gz <font color="yellow">if</font>present in input<br></font>
    root_dir=<font color=#00ffff>$3</font><br>
    fastq_end1=<font color=#00ffff>$4</font><br>
    fastq_end2=<font color=#00ffff>$5</font> <font color="blue">#is "NULL" <font color="yellow">if</font>no reverse reads<br></font>
    input_address=<font color=#00ffff>$6</font>    <font color="blue">#this is an s3 address e.g. s3://path/to/input/directory<br></font>
    output_address=<font color=#00ffff>$7</font>   <font color="blue">#this is an s3 address e.g. s3://path/to/output/directory<br></font>
    log_dir=<font color=#00ffff>$8</font><br>
    is_zipped=<font color=#00ffff>$9</font>    <font color="blue">#either "True" or "False", indicates whether input is gzipped<br></font>
    </p>
    <p><font color="blue">#logging<br></font>
    mkdir -p <font color=#00ffff>$log_dir</font><br>
    log_file=<font color=#00ffff>$log_dir</font>/'<font color="red">SCRIPT_LOG_FILE_HERE</font>.log'<br>
    exec 1>><font color=#00ffff>$log_file</font><br>
    exec 2>><font color=#00ffff>$log_file</font><br>
    </p>
    <p>
    <font color="blue">#prepare output directories</font><br>
    workspace=<font color=#00ffff>$root_dir</font>/<font color=#00ffff>$project_name</font>/<font color=#00ffff>$fastq_end1</font><br>
    software_dir=/shared/workspace/software<br>
    <font color="red">VARIABLES FOR SOFTWARE PATHS HERE</font><br>
    &nbsp;&nbsp;&nbsp;<font color="red">Example:</font>
    &nbsp;&nbsp;fastqc=<font color=#00ffff>$software_dir</font>/FastQC/fastqc<br>
    mkdir -p <font color=#00ffff>$workspace</font><br>
    </p>
    <p>
    <font color="blue">##DOWNLOAD##<br></font>
    if [ ! -f $workspace/$fastq_end1$file_suffix ]<br>
    then<br>
    &nbsp;&nbsp; <font color="blue">#this is the suffix of the input from s3<br></font>
    &nbsp;&nbsp; download_suffix=$file_suffix<br>
    <br>
    &nbsp;&nbsp; <font color="blue">#changes extension if S3 input is zipped<br></font>
    &nbsp;&nbsp; if [ "$is_zipped" == "True" ]<br>
    &nbsp;&nbsp;&nbsp;&nbsp; then<br>
    &nbsp;&nbsp;&nbsp;&nbsp; download_suffix=$file_suffix".gz"<br>
    &nbsp;&nbsp; fi<br>
    <br>
    &nbsp;&nbsp; <font color="blue">#always download forward reads<br></font>
    &nbsp;&nbsp; aws s3 cp $input_address/$fastq_end1$download_suffix $workspace/<br>
    &nbsp;&nbsp; gunzip -q $workspace/$fastq_end1$download_suffix<br>
    <br>
    &nbsp;&nbsp; <font color="blue">#download reverse reads if they exist<br></font>
    &nbsp;&nbsp; if [ "$fastq_end2" != "NULL" ]<br>
    &nbsp;&nbsp; then<br>
    &nbsp;&nbsp;&nbsp;&nbsp; aws s3 cp $input_address/$fastq_end2$download_suffix $workspace/<br>
    &nbsp;&nbsp;&nbsp;&nbsp; gunzip -q $workspace/$fastq_end2$download_suffix<br>
    &nbsp;&nbsp; fi<br>
    fi<br>
    <font color="blue"><font color="blue">##END_DOWNLOAD##<br></font></font>
    </p>
    <p>
    <font color="blue">##</font><font color="red">YOUR-TOOL</font><font color="blue">##</font> 
    <font color="blue">##</font><font color="red">END_YOUR-TOOL</font><font color="blue">##</font>
    </p>
</body>

</html>


